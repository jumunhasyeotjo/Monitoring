global:
  resolve_timeout: 5m

route:
  receiver: slack-warning
  group_by: ["alertname", "service"]
  group_wait: 10s
  group_interval: 1m
  repeat_interval: 4h

  routes:
    # =========================
    # Critical Alerts
    # =========================
    - matchers:
        - severity="critical"
      receiver: critical-notifications
      repeat_interval: 30m

    # =========================
    # Warning Alerts
    # =========================
    - matchers:
        - severity="warning"
      receiver: slack-warning

receivers:
  # =========================
  # Critical: Slack
  # =========================
  - name: critical-notifications
    slack_configs:
      - api_url: ${SLACK_CRIT_WEBHOOK_URL}
        channel: "#criti_message"
        title: "ğŸš¨ [CRITICAL] {{ .CommonAnnotations.summary }}"
        text: >-
          ğŸš¨ *CRITICAL ì¥ì•  ë°œìƒ*

          *ì„œë¹„ìŠ¤* ğŸ‘‰ {{ or .CommonLabels.service .CommonLabels.job "N/A" }}

          *ì‹¬ê°ë„* ğŸ‘‰ {{ .CommonLabels.severity }}

          *ë°œìƒ ì‹œê°* {{ range .Alerts }}
          â± {{ .StartsAt.Format "2006-01-02 15:04:05" }}
          {{ end }}

          *ì›ì¸ ìš”ì•½* {{ if .CommonAnnotations.reason }}
          âš ï¸ {{ .CommonAnnotations.reason }}
          {{ else }}
          âš ï¸ ì›ì¸ ì •ë³´ ì—†ìŒ
          {{ end }}

          *ìƒì„¸ ë‚´ìš©* {{ .CommonAnnotations.description }}

        send_resolved: true

  # =========================
  # Warning: Slack only
  # =========================
  - name: slack-warning
    slack_configs:
      - api_url: ${SLACK_WARN_WEBHOOK_URL}
        channel: "#warn_message"
        title: "âš ï¸ [WARNING] {{ .CommonAnnotations.summary }}"
        text: >-
          âš ï¸ *WARNING ì¥ì•  ê°ì§€*

          *ì„œë¹„ìŠ¤* ğŸ‘‰ {{ or .CommonLabels.service .CommonLabels.job "N/A" }}

          *ì‹¬ê°ë„* ğŸ‘‰ {{ .CommonLabels.severity }}

          *ë°œìƒ ì‹œê°* {{ range .Alerts }}
          â± {{ .StartsAt.Format "2006-01-02 15:04:05" }}
          {{ end }}

          *ì›ì¸ ìš”ì•½* {{ if .CommonAnnotations.reason }}
          âš ï¸ {{ .CommonAnnotations.reason }}
          {{ else }}
          âš ï¸ ì›ì¸ ì •ë³´ ì—†ìŒ
          {{ end }}

          *ìƒì„¸ ë‚´ìš©* {{ .CommonAnnotations.description }}

        send_resolved: false